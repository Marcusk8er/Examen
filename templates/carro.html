<!DOCTYPE html>
<html lang="en">
{% load static %}
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!--BOOTSTRAP-->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
  <!--ICONOS-->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.3/font/bootstrap-icons.css">
  <script src="https://unpkg.com/boxicons@2.1.2/dist/boxicons.js" defer></script>
  <!--FUENTES-->
  <!--FUENTES 1-->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Akshar:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <!--FUENTE 2-->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Road+Rage&display=swap" rel="stylesheet">

  <!--SCRIPT-->
  <script src="https://kit.fontawesome.com/2c36e9b7b1.js" defer></script>
  <script src="../static/js/xd.js" defer></script>
  <title>Carro de compras</title>
  
</head>

<body style="font-family: 'Akshar'">
  <!--HEADER COMIENZA-->
  <header>
  </header>
  <!--HEADER TERMINA-->
  <!--NAVBAR COMIENZA-->
  <nav class="navbar navbar-expand-lg bg-dark">
    <div class="container-fluid">
      <a class="navbar-brand text-light fs-3" style="font-family: 'Road Rage', cursive;" href="#">MusicPRO</a>
      <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
        <div class="navbar-nav">
          <a class="nav-link active text-light mx-4" aria-current="page" href="{% url 'index' %}">Inicio</a>
          <a class="nav-link text-light mx-2" href="{% url 'productos' %}">Productos</a>
        </div>
      </div>
    </div>
    {% if user.is_authenticated %}
    <div style="display: flex">
      <a class="nav-link text-light me-2" href="#"><i class="bi bi-person-check-fill"></i></a>
      <a class="nav-link text-light me-3" href="#">{{user.username}}</a>
      <a class="nav-link text-light me-5" href="{% url 'logout' %}"><i class="bi bi-person-x-fill"></i></a> 
      {% else %}
      <div style="display: flex;">
        <a class="nav-link text-light me-3" href="{% url 'login' %}"><i class="bi bi-person-fill"></i></a>
        <a class="nav-link text-light me-5" href="{% url 'registro'%}"><i class="bi bi-person-plus-fill"></i></a>
      </div>
      {% endif %}
    </div>
  </nav>
  <!--NAVBAR TERMINA-->
  <!--MAIN TERMINA-->
  <main>
    <div style="margin: 10px 300px 150px 300px;">
      <table class="table table-dark table-striped">
        <header>
          <h2 class="text-center m-3">Carro de compras</h1>
        </header>
        {% if request.session.carro.items %}
        {% for key, value in request.session.carro.items %}
        <form action="POST" name="formFalso" style="display: none;">
          <input style="display: none;" type="text" id='nombre_usuarioForm' name="nombre_usuario" value="{{user.username}}">
          <input style="display: none;" type="text" id='nombreProductoForm' name="nombreProducto" value="{{value.nombre}}">
          <input style="display: none;" type="text" id='cantidadForm' name="cantidad" value="{{value.cantidad}}">
          <input style="display: none;" type="text" id='valor_totalForm' name="valor_total" value="{{value.acumulado}}">
        </form>
        {% endfor %}
        {% else %}
        <tr style="display: none;">
          <td colspan="5">
            <div class="alert alert-dark text-center fs-2"> Sin Productos </div>
          </td>
        </tr>
        {% endif %}
        <tr>
          <th>Producto</th>
          <th style="text-align: center;">Valor</th>
          <th style="text-align: center;">Cantidad</th>
          <th style="text-align: center;">Agregar o Quitar</th>
          <th style="text-align: center;"><a href="{% url 'CLS' %}" class="btn btn-light">Limpiar</a><a href="{% url 'pedido' %}" class="ms-2 btn btn-light">Realizar Pedido</a></th>
        </tr>
        {% if request.session.carro.items %}
        {% for key, value in request.session.carro.items %}
        <p id="cantidad" hidden>{{value.cantidad}}</p>
        <tr>
          <td id="nombre">{{value.nombre}}</td>
          <td id="valor_total" style="text-align: center;">${{value.acumulado}}</td>
          <td id="cantidad" style="text-align: center;">{{value.cantidad}}</td>
          <td style="text-align: center;">
            <a href="{% url 'Add' value.producto_id %}" style="margin-right: 10px;"><box-icon name='plus-square' type='solid' color='rgba(253,251,251,0.98)' ></box-icon></a>
            <a href="{% url 'Sub' value.producto_id %}" style="margin-left: 60px;"><box-icon name='minus-square' type='solid' color='rgba(253,251,251,0.98)' ></box-icon></a>
          </td>
        </tr>
        {% endfor %}
        {% else %}
        <tr>
          <td colspan="5">
            <div class="alert alert-dark text-center fs-2"> Sin Productos </div>
          </td>
        </tr>
        {% endif %}
      </table>
      <table class="table table-dark table-striped">
        <tr>
          <th style="text-align: center;"> Total </th>
          <th style="text-align: center;"> Total en dolares </th>
          <th style="text-align: center;"> Valor dolar hoy </th>
        </tr>
        <tr>
          <p id='valor' style="display: none">{{total_carro}}</p>
          <td id='total_carro' style="text-align: center;">${{total_carro}} CLP</td>
          <td id='total_dolares' style="text-align: center;">${% widthratio total_carro valor_dolar 1 %} USD</td>
          <td id='valor_dolar' style="text-align: center;">${{valor_dolar}} USD</td>
        </tr>
      </table>
    </div>
  </main>
  <!--MAIN TERMINA-->
  <!--FOOTER COMIENZA-->
  <footer class="bg-dark text-center text-white fixed-bottom">
    <!-- Grid container -->
    <div class="container p-4 pb-0">
      <!-- Section: Social media -->
      <section class="mb-4">
        <!-- Facebook -->
        <a class="btn btn-outline-light btn-floating m-1" href="#!" role="button"
          ><i class="fab fa-facebook-f"></i
        ></a>
  
        <!-- Twitter -->
        <a class="btn btn-outline-light btn-floating m-1" href="#!" role="button"
          ><i class="fab fa-twitter"></i
        ></a>
  
        <!-- Instagram -->
        <a class="btn btn-outline-light btn-floating m-1" href="#!" role="button"
          ><i class="fab fa-instagram"></i
        ></a>
  
      </section>
      <!-- Section: Social media -->
    </div>
    <!-- Grid container -->
  
    <!-- Copyright -->
    <div class="text-center p-3" style="background-color: rgba(0, 0, 0, 0.2);">
      Â© 2022 Copyright:
      <a class="text-white" href="https://mdbootstrap.com/">MusicPro.cl</a>
    </div>
    <!-- Copyright -->
  </footer>
  <!--FOOTER TERMINA-->
</body>

</html>